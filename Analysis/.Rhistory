data = read_xlsx('Data_Table.xlsx')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
data = read_xlsx('Data_Table.xlsx')
library(readxl);
data = read_xlsx('Data_Table.xlsx')
View(data)
str(data)
data = data.frame(data);
str(data)
data = read_xlsx('Data_Table.xlsx');
data = data.frame(data);
str(data)
data = read_xlsx('Data_Table.xlsx');
data = data.frame(data);
# Set factor variables
data$ID soggetto <- as.factor(data$`ID soggetto`);
data$Genere <- as.factor(data$Genere);
data = read_xlsx('Data_Table.xlsx');
data = data.frame(data);
# Set factor variables
data$ID_soggetto <- as.factor(data$`ID_soggetto`);
data$Genere <- as.factor(data$Genere);
str(data)
na.omit(data)
# Discard rows with NaN
data = na.omit(data)
view(data)
View(data)
View(data)
data = read_xlsx('Data_Table.xlsx');
data = data.frame(data);
# Set factor variables
data$ID_soggetto <- as.factor(data$`ID_soggetto`);
data$Genere <- as.factor(data$Genere);
# Set numerical variables
data$TMT_BA = as.numeric(data$TMT_BA);
data$MFPI_Flessibilità = as.numeric(data$MFPI_Flessibilità);
data$MFPI_Inflessibilità = as.numeric(data$MFPI_Inflessibilità);
# Discard rows with NaN
data = na.omit(data)
View(data)
#################################################
############### Cluster Analysis ################
#################################################
#################################################
install.packages('tidyverse');
library(tidyverse);
# Get dataframe without demographics
data_noDemo = data %>%
select(- ID_soggetto, - Genere, - Età, - Scolarità)
install.packages('cluster');
library(cluster);
pam(data_noDemo, k = 2, metric = "euclidean")
help sclae
help scale
help(scale)
data_clust = pam(data_noDemo, k = 3)
clusplot(data_noDemo, data_clust$medoids)
#################################################
############### Cluster Analysis ################
#################################################
#################################################
install.packages('tidyverse');
install.packages("tidyverse")
library(readxl);
library(tidyverse);
data = read_xlsx('Data_Table.xlsx');
data = data.frame(data);
# Set factor variables
data$ID_soggetto <- as.factor(data$`ID_soggetto`);
data$Genere <- as.factor(data$Genere);
# Set numerical variables
data$TMT_BA = as.numeric(data$TMT_BA);
data$MFPI_Flessibilità = as.numeric(data$MFPI_Flessibilità);
data$MFPI_Inflessibilità = as.numeric(data$MFPI_Inflessibilità);
# Discard rows with NAs
data = na.omit(data);
# Get dataframe without demographics
data_noDemo = data %>%
select(- ID_soggetto, - Genere, - Età, - Scolarità);
View(data_noDemo)
# Check for gaussianity (if normal, we use pearson, otherwise Spearman)
shapiro.tes(data_noDemo$CRIq_tot)
# Check for gaussianity (if normal, we use pearson, otherwise Spearman)
shapiro.test(data_noDemo$CRIq_tot)
shapiro.test(data_noDemo$MoCA_tot)
shapiro.test(data_noDemo$TMT_BA)
install.packages('Hmisc');
library(Hmisc);
# Run Correlations
corr_results <- rcorr(as.matrix(data_noDemo), type = "spearman");
View(corr_results)
View(corr_results)
# Let's flatten the result matrix for better visualization
flattenCorrMatrix = function(cormat,pmat) {
upper_tri <- upper.tri(cormat)
data.frame(
Var1 = rownames(cormat)[row(cormat)[upper_tri]],
Var2 = rownames(cormat)[col(cormat)[upper_tri]],
cor = cormat[upper_tri],
p = pmat[upper_tri])
};
corr = flattenCorrMatrix(r_matrix, p_matrix);
# Get Spearman r and pvalues matrices
r_matrix <- corr_results$r;
p_matrix <- corr_results$;
# Let's flatten the result matrix for better visualization
flattenCorrMatrix = function(cormat,pmat) {
upper_tri <- upper.tri(cormat)
data.frame(
Var1 = rownames(cormat)[row(cormat)[upper_tri]],
Var2 = rownames(cormat)[col(cormat)[upper_tri]],
cor = cormat[upper_tri],
p = pmat[upper_tri])
};
corr = flattenCorrMatrix(r_matrix, p_matrix);
p_matrix <- corr_results$P;
# Let's flatten the result matrix for better visualization
flattenCorrMatrix = function(cormat,pmat) {
upper_tri <- upper.tri(cormat)
data.frame(
Var1 = rownames(cormat)[row(cormat)[upper_tri]],
Var2 = rownames(cormat)[col(cormat)[upper_tri]],
cor = cormat[upper_tri],
p = pmat[upper_tri])
};
corr = flattenCorrMatrix(r_matrix, p_matrix);
View(corr)
# Filter for p<0.05
corr_flat_sig <- corr_flat %>%
filter(p < 0.05)
corr_flat = flattenCorrMatrix(r_matrix, p_matrix);
# Filter for p<0.05
corr_flat_sig <- corr_flat %>%
filter(p < 0.05)
View(corr_flat_sig)
# Round for readibility
corr_flat_sig$cor <- round(corr_flat_sig$cor, 3);
corr_flat_sig$p <- round(corr_flat_sig$p, 3);
write_csv(corr_flat_sig, "Significant_Results.csv", row.names = FALSE)
write_csv(corr_flat_sig, "Significant_Results.csv")
# Round for readibility
corr_flat_sig$cor <- round(corr_flat_sig$cor, 7);
corr_flat_sig$p <- round(corr_flat_sig$p, 7);
write_csv(corr_flat_sig, "Significant_Results.csv")
write_csv(corr_flat_sig, "Significant_Results.csv")
# FDR correction for multiple comparison
corr_flat$p_adj <- p.adjust(corr_flat$p, method = "fdr");
cor_flat_sig_adj <- corr_flat %>%
filter(p_adj < 0.05)
# Save file
write_csv(corr_flat_sig, "Significant_Results_FDR.csv")
corr_flat = flattenCorrMatrix(r_matrix, p_matrix);
# Filter for p<0.05
corr_flat_sig <- corr_flat %>%
filter(p < 0.05)
# Round for readibility
corr_flat_sig$cor <- round(corr_flat_sig$cor, 20);
corr_flat_sig$p <- round(corr_flat_sig$p, 20);
# Save file
write_csv(corr_flat_sig, "Significant_Results.csv")
# Save file
write_csv(corr_flat_sig, "Significant_Results.csv")
# FDR correction for multiple comparison
corr_flat$p_adj <- p.adjust(corr_flat$p, method = "fdr");
cor_flat_sig_adj <- corr_flat %>%
filter(p_adj < 0.05)
# Save file
write_csv(corr_flat_sig, "Significant_Results_FDR.csv")
# Save file
write_csv(corr_flat_sig_adj, "Significant_Results_FDR.csv")
# FDR correction for multiple comparison
corr_flat$p_adj <- p.adjust(corr_flat$p, method = "fdr");
View(cor_flat_sig_adj)
cor_flat_sig_adj <- corr_flat %>%
filter(p_adj < 0.05)
View(cor_flat_sig_adj)
# Save file
write_csv(corr_flat_sig_adj, "Significant_Results_FDR.csv")
corr_flat_sig_adj <- corr_flat %>%
filter(p_adj < 0.05)
# Save file
write_csv(corr_flat_sig_adj, "Significant_Results_FDR.csv")
# Save file
write_csv(corr_flat_sig_adj, "Significant_Results_FDR.csv")
#################################################
############### Cluster Analysis ################
#################################################
#################################################
install.packages('tidyverse');
install.packages("tidyverse")
library(readxl);
library(tidyverse);
library(Hmisc);
source('Custom_Function/flattnCorrMatrix.R')
source('Custom_Function/flattnCorrMatrix.R')
source("Custom_Function/flattnCorrMatrix.R")
source("Custom_Function/flattenCorrMatrix.R")
data = read_xlsx('Data_Table.xlsx');
data = data.frame(data);
# Set factor variables
data$ID_soggetto <- as.factor(data$`ID_soggetto`);
data$Genere <- as.factor(data$Genere);
# Set numerical variables
data$TMT_BA = as.numeric(data$TMT_BA);
data$MFPI_Flessibilità = as.numeric(data$MFPI_Flessibilità);
data$MFPI_Inflessibilità = as.numeric(data$MFPI_Inflessibilità);
# Discard rows with NAs
data = na.omit(data);
# Get dataframe without demographics
data_noDemo = data %>%
select(- ID_soggetto, - Genere, - Età, - Scolarità);
# Check for gaussianity (if normal, we use pearson, otherwise Spearman)
shapiro.test(data_noDemo$CRIq_tot); #Normal
shapiro.test(data_noDemo$MoCA_tot); #Normal
shapiro.test(data_noDemo$TMT_BA); #Not normal. We will use spearman
# Run Correlations
corr_results <- rcorr(as.matrix(data_noDemo), type = "spearman");
# Get Spearman r and pvalues matrices
r_matrix <- corr_results$r;
p_matrix <- corr_results$P;
# Let's flatten the result matrix for better visualization
flattenCorrMatrix = function(cormat,pmat) {
upper_tri <- upper.tri(cormat)
data.frame(
Var1 = rownames(cormat)[row(cormat)[upper_tri]],
Var2 = rownames(cormat)[col(cormat)[upper_tri]],
cor = cormat[upper_tri],
p = pmat[upper_tri])
};
# Let's flatten the result matrix for better visualization
corr_flat = flattenCorrMatrix(r_matrix, p_matrix);
# Filter for p<0.05
corr_flat_sig <- corr_flat %>%
filter(p < 0.05)
# Round for readibility
corr_flat_sig$cor <- round(corr_flat_sig$cor, 20);
corr_flat_sig$p <- round(corr_flat_sig$p, 20);
